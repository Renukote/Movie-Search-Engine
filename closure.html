<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            font-family: Roboto, Arial, sans-serif;
            background:#131212;
        }
        body ::-webkit-scrollbar {
            display: none;
            font-family: Roboto, Arial, sans-serif;
        }
        #suggestions {
            background: rgb(46, 45, 45);
            position:fixed;
            top: 48px;
            left:312px;
            width:635px;
            color:white;
            z-index:10;
        }
        #movies {
            height: 310px;
            overflow: scroll;
            text-align: left;
            padding: 1%;
            background:  #131212;
            position: relative;
            top:50px;
            left:270px;
            width:78%;
            display: none;
            z-index: 1;
        }
        #movies > div {
            display: grid;
            margin:0px 30px;
            grid-template-columns: 230px 750px;
            font-size:14px;
            width:900px;
            height: 300px;
            color: white;
        }
        #movies > div > img { 
            height: 300px;
            box-shadow: 5px 5px 2px 1px rgba(84, 84, 85, 0.2);
        }
        body #movies > div > div > div,h3 {
            margin:10px 0px;
            padding:5px;
        }
        body #movies > div > div p {
            height:30px;
            overflow:hidden;
        }
        body #movies > div > div b {
            font-weight:600px;
        }

    </style>

    <!-- header -->
    <style>
            header {
                height: 40px;
                background: #181818;
                padding:0px 15px;
                display: flex;
                position: fixed;
                top: 0;
                left: 0;
                width:100%;
                padding:8px 10px;
                border-bottom: 1px solid rgb(53, 52, 52);
                z-index: 999;
            }
            #menu-list {
                width: 25px;
                padding-left:10px;
            }
            #logo {
                width:90px;
                padding-left:22px;
                font-size: 26px;
                color:orangered;
                margin:0px;
                padding:0px
            }
            #search-bar {
                text-align: center;
                padding-left:155px;
                height:40px;
                overflow:hidden;
                display:flex;
                /* padding:10px; */
                border-radius: 3px;
            }
            #search-bar  input {
                width:550px;
                background:  hsl(0, 0%, 7%);
                padding: 10px;
                outline:none;
                border: 2px solid rgb(41, 40, 40);
                font-size: 17px;
                color:grey;
            }
            #search-button {
                background: rgb(46, 45, 45);
                border: none; 
                margin-left:-5px;
                padding: 0px 20px;
            }
            #voice {
                width:25px;
                height:25px;
                background-color: hsl(0, 0%, 7%);
                border-radius:22px;
                text-align:center;
                padding:8px;
                margin: 0px 8px;
            }
            #add-video {
                width:25px;
                padding-left:105px;
            }
            #apps {
                width:25px;
                padding-left:22px;
            }
            #notifications {
                width:25px;
                padding-left:24px;
            }
            #profile {
                padding:8px;
                padding-left:25px;
            }
            #profile img {
                border-radius:45%;
            }
    </style>

    <!-- sidebar -->
    <style>
        #side-bar {
            width:250px;
            position:fixed;
            left:0;
            top:55px;
            background:#181818;
            color:white;
            padding:10px;
            border: none;
            z-index: 999;
        }
        #side-bar > div > div  {
            display:flex;
            padding:15px 10px;
            border-bottom: 1px solid rgb(44, 44, 44);
            margin:20px 0px;
        }
        #side-bar > div > div > div:nth-child(2)  {
            padding:5px 20px;
        }
        #side-bar > div:nth-child(3){

            font-size: 14px;
        }
        #side-bar > div:nth-child(3) img {
            border-radius: 50%;
        }
        #side-bar > div:nth-child(3) > div >  div:nth-child(2)  {
            flex-grow:1;
        }

    </style>

    <!-- popular movies -->
    <style>
    #popular-movies {
        text-align: left;
        padding: 1%;
        background:  #131212;
        position: relative;
        top:50px;
        left:270px;
        width:78%;
        display:grid;
        grid-template-columns: repeat(4,250px);
        grid-gap:1.5%;
        color:white;
        z-index:1;
    }
    #popular-movies > div {
        box-shadow: #181818;
        overflow:hidden;
        height: 350px;
    }
    #popular-movies > div:hover {
        display:zoom;
        transform: scale(1.1);
    }
    #popular-movies > div * {
        margin:10px 0px;
        padding:0px;
    }
    #popular-movies img {
        width: 100%;
        height:200px;
    }
    #popular-movies > div > div  p {
        overflow:hidden;
        height:40px;
        font-size:12px;
    }
    </style>

    <!-- signin-dropdown -->
    <style>
        #user-login {
            position: absolute;
            right:80px;
            top: 60px;
            width:250px;
            height: fit-content;
            padding:15px;
            background: rgb(31, 30, 30);
            display: flex;
            flex-direction: column;
            border: 2px solid rgb(41, 40, 40);
            color:white;
            justify-content: center;
            z-index:99;
        }
        #user-login > form  div {
            height:40px;
            border:1px solid black;
            width:100px;
            margin:10px auto;
        }
        #user-login input{
            width:90%;
            padding:5px;
            background:  hsl(0, 0%, 7%);
            outline: none;
            border: 2px solid rgb(41, 40, 40);
            color:white;
        }
        #user-login div > div {
            margin:40px auto;
            width: fit-content;
            min-width: 50%;
            padding: 10px;
            border: 2px solid rgb(41, 40, 40);
            background: rgb(31, 30, 30);
            text-align: center;
        }
        #user-login p {
            margin:5px;
            margin-top:15px;
            font-size:12px;
        }
        #user-login, #message, #signup {
            display:none;    
        }
        #user-login #message {
            height:20px;
            width: 90%;
            text-align:center;
            margin: 0px auto;
            color: green;
        }
    </style>

</head>
<body>
    
    <!-- header -->
    <header>
            <div id = 'menu-list'>
                <svg fill = 'white' viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet"  class="style-scope yt-icon" style="pointer-events: none; display: block; width: 24px; height: 24px;; color: white"><g style = "color: white;"><path d="M21,6H3V5h18V6z M21,11H3v1h18V11z M21,17H3v1h18V17z" class="style-scope yt-icon" style='color: white'></path></g></svg>
            </div>
            
            <div id = 'logo'>
                <h3>Binge.</h3>
            </div>
            
            <form oninput = 'debounce(main,800)'>
                <div id = 'search-bar'>
                        <input type = 'text' id = 'query' placeholder = 'Search' />
                        <button onclick = 'debounce(main,800)' id = 'search-button'>
                            <svg fill = 'white' viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 25px; height: 25px; "><g class="style-scope yt-icon"><path d="M20.87,20.17l-5.59-5.59C16.35,13.35,17,11.75,17,10c0-3.87-3.13-7-7-7s-7,3.13-7,7s3.13,7,7,7c1.75,0,3.35-0.65,4.58-1.71 l5.59,5.59L20.87,20.17z M10,16c-3.31,0-6-2.69-6-6s2.69-6,6-6s6,2.69,6,6S13.31,16,10,16z" class="style-scope yt-icon"></path></g></svg>
                        </button>
                    </div>
                </form>
    
            <div id = 'voice'>
                <svg fill = 'white' viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 25px; height: 25px;"><g class="style-scope yt-icon"><path d="M12 3C10.34 3 9 4.37 9 6.07V11.93C9 13.63 10.34 15 12 15C13.66 15 15 13.63 15 11.93V6.07C15 4.37 13.66 3 12 3ZM18.5 12H17.5C17.5 15.03 15.03 17.5 12 17.5C8.97 17.5 6.5 15.03 6.5 12H5.5C5.5 15.24 7.89 17.93 11 18.41V21H13V18.41C16.11 17.93 18.5 15.24 18.5 12Z" class="style-scope yt-icon"></path></g></svg>
            </div>
            
            <div id = 'add-video'>
                <svg fill = 'white' viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 100%; height: 100%;"><g class="style-scope yt-icon"><path d="M14,13h-3v3H9v-3H6v-2h3V8h2v3h3V13z M17,6H3v12h14v-6.39l4,1.83V8.56l-4,1.83V6 M18,5v3.83L22,7v8l-4-1.83V19H2V5H18L18,5 z" class="style-scope yt-icon"></path></g></svg>
            </div>
    
            <div id = 'apps'>
                <svg fill = 'white' viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 100%; height: 100%;"><g class="style-scope yt-icon"><path d="M16,4v4h4V4H16z M19,7h-2V5h2V7z M16,10v4h4v-4H16z M19,13h-2v-2h2V13z M10,4v4h4V4H10z M13,7h-2V5h2V7z M10,10v4h4v-4H10z M13,13h-2v-2h2V13z M16,16v4h4v-4H16z M19,19h-2v-2h2V19z M10,16v4h4v-4H10z M13,19h-2v-2h2V19z M4,4v4h4V4H4z M7,7H5V5h2V7z M4,10 v4h4v-4H4z M7,13H5v-2h2V13z M4,16v4h4v-4H4z M7,19H5v-2h2V19z" class="style-scope yt-icon"></path></g></svg>
            </div>
            
            <div id = 'notifications'>
                <svg fill = 'white' viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 100%; height: 100%;"><g class="style-scope yt-icon"><path d="M10,20h4c0,1.1-0.9,2-2,2S10,21.1,10,20z M20,17.35V19H4v-1.65l2-1.88v-5.15c0-2.92,1.56-5.22,4-5.98V3.96 c0-1.42,1.49-2.5,2.99-1.76C13.64,2.52,14,3.23,14,3.96l0,0.39c2.44,0.75,4,3.06,4,5.98v5.15L20,17.35z M19,17.77l-2-1.88v-5.47 c0-2.47-1.19-4.36-3.13-5.1c-1.26-0.53-2.64-0.5-3.84,0.03C8.15,6.11,7,7.99,7,10.42v5.47l-2,1.88V18h14V17.77z" class="style-scope yt-icon"></path></g></svg>
            </div>
    
            <div id = 'profile' onclick = 'toggle("user-login")'>
                <img alt="Avatar image" height="32" width="32" src="https://yt3.ggpht.com/yti/APfAmoEQgEoGjaHuJ351bBPzr0T3HPeZEiWsffNVvRuNIA=s88-c-k-c0x00ffffff-no-rj-mo">
            </div>
    </header>

    <!-- signin dropdown -->
    <div id = 'user-login'>

            <p id="message"></p>
    
            <div id = 'signup'>
                <p>Name</p>
                <input type = 'text' placeholder="name" id = 'signup-name'/>
    
                <p>Email</p>
                <input type = 'email' placeholder = 'email' id = 'signup-email'/>
    
                <p>Password</p>
                <input type = 'password' placeholder = 'password' id = 'signup-password'/>
    
                <p>Username</p>
                <input type = 'text' placeholder = 'username' id = 'signup-username'/>
    
                <p>Mobile</p>
                <input type = 'tel' placeholder = 'mobile' id = 'signup-mobile'/>
    
                <p>Description</p>
                <input type = 'text' placeholder = 'description' id = 'signup-description'/>
    
                <div onclick = 'sUp()'> Sign Up </div>
    
                <div onclick = "showHide('login','signup')"> Have an account? Login </div>
    
            </div>
    
            <div id = 'login'>
                <p>Email</p>
                <input type = 'text' id = 'login-username' placeholder = 'Enter username'>
    
                <p>Password</p>
                <input type = 'password' id = 'login-password' placeholder = 'Enter your password'/>
    
                <div onclick = 'lIn()'> Log in </div>
                
                <div onclick = "showHide('signup','login')"> New user? Sign up </div>
            </div>
            
    
    </div>
    
    <!-- side-bar -->
    <div id = 'side-bar'>
        
        <!-- 1st div  -->
        <div>
            <div onclick = 'getTrendingList()'>
                <div>
                    <svg  fill = 'white' viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 24px; height: 24px;"><g class="style-scope yt-icon"><path d="M4,10V21h6V15h4v6h6V10L12,3Z" class="style-scope yt-icon"></path></g></svg>
                </div>
                <div>Popular</div>
            </div>
    
            <div onclick = 'getGenre(53)'>
                <div>
                    <svg fill = 'white' xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><path d="M9.8,9.8l-3.83,8.23l8.23-3.83l3.83-8.23L9.8,9.8z M13.08,12.77c-0.21,0.29-0.51,0.48-0.86,0.54 c-0.07,0.01-0.15,0.02-0.22,0.02c-0.28,0-0.54-0.08-0.77-0.25c-0.29-0.21-0.48-0.51-0.54-0.86c-0.06-0.35,0.02-0.71,0.23-0.99 c0.21-0.29,0.51-0.48,0.86-0.54c0.35-0.06,0.7,0.02,0.99,0.23c0.29,0.21,0.48,0.51,0.54,0.86C13.37,12.13,13.29,12.48,13.08,12.77z M12,3c4.96,0,9,4.04,9,9s-4.04,9-9,9s-9-4.04-9-9S7.04,3,12,3 M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2 L12,2z"></path></svg>
                </div>
                <div>Thirller</div>
            </div>
    
            <div onclick = 'getGenre(35)'>
                <div>
                    <svg fill = 'white' xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><path d="M10,18v-6l5,3L10,18z M17,3H7v1h10V3z M20,6H4v1h16V6z M22,9H2v12h20V9z M3,10h18v10H3V10z"></path></svg>
                </div>
                <div>Comedy</div>
            </div>

        </div>

        <!-- 2nd div -->
        <div>
                
            <div onclick = 'getGenre(28)'>
                <div>
                    <svg fill = 'white' xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><path d="M11,7l6,3.5L11,14V7L11,7z M18,20H4V6H3v15h15V20z M21,18H6V3h15V18z M7,17h13V4H7V17z"></path></svg>
                </div>
                <div>Action</div>
            </div>

            <div onclick = 'getGenre(80)'>
                <div>
                    <svg fill = 'white' viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block;width: 24px; height: 24px;"><g class="style-scope yt-icon"><path d="M14.97,16.95L10,13.87V7h2v5.76l4.03,2.49L14.97,16.95z M22,12c0,5.51-4.49,10-10,10S2,17.51,2,12h1c0,4.96,4.04,9,9,9 s9-4.04,9-9s-4.04-9-9-9C8.81,3,5.92,4.64,4.28,7.38C4.17,7.56,4.06,7.75,3.97,7.94C3.96,7.96,3.95,7.98,3.94,8H8v1H1.96V3h1v4.74 C3,7.65,3.03,7.57,3.07,7.49C3.18,7.27,3.3,7.07,3.42,6.86C5.22,3.86,8.51,2,12,2C17.51,2,22,6.49,22,12z" class="style-scope yt-icon"></path></g></svg>
                </div>
                <div>Crime</div>
            </div>

            <div onclick = 'getGenre(878)'>
                <div>
                    <svg fill = 'white' viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 24px; height: 24px;"><g class="style-scope yt-icon"><path d="M10,8l6,4l-6,4V8L10,8z M21,3v18H3V3H21z M20,4H4v16h16V4z" class="style-scope yt-icon"></path></g></svg>
                </div>
                <div>Sci-Fi</div>
            </div>

            <div onclick = 'getGenre(27)'>
                <div>
                    <svg fill = 'white' viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" class="style-scope yt-icon" style="pointer-events: none; display: block; width: 24px; height: 24px;;"><g class="style-scope yt-icon"><path d="M14.97,16.95L10,13.87V7h2v5.76l4.03,2.49L14.97,16.95z M12,3c-4.96,0-9,4.04-9,9s4.04,9,9,9s9-4.04,9-9S16.96,3,12,3 M12,2c5.52,0,10,4.48,10,10s-4.48,10-10,10S2,17.52,2,12S6.48,2,12,2L12,2z" class="style-scope yt-icon"></path></g></svg>
                </div>
                <div>Horror</div>
            </div>
        </div>
    </div>

    <div id = 'suggestions'></div>

    <div id = 'movies'></div>

    <div id = 'popular-movies'></div>

</body>
</html>

<script>
    let timerId;

    // Search movies  -- done
    async function searchMovies( movieName ) {
        try { 
            let suggestions = document.getElementById('suggestions');
            suggestions.style.display = 'inline';

            let res = await fetch(`http://www.omdbapi.com/?apikey=453161dd&tt1285016&s=${movieName}`)
            var data = await res.json();
        }
        catch (error) {
            console.log( error );
        }

        // console.log( data );
        appendMovies( data.Search);
        return data;
    }
    
    // Movies suggestion Engine -- done
    function appendMovies(movies) {
        let suggestions = document.getElementById('suggestions');
        suggestions.innerHTML  = "";

        movies.forEach( function (movie) {
            let p = document.createElement('p');
            p.innerText = movie.Title;  
            p.style.margin = '15px'
            p.onclick = showDetails;
            suggestions.append(p);
        })
    }

    // Show details of a movie when clicked on a suggestion
    async function showDetails(){
        let suggestions = document.getElementById('suggestions');
        suggestions.style.display = 'none';

        let container = document.getElementById("movies");
        container.innerHTML = "";
        container.style.display = 'inline';


        let movieName = event.target.textContent;

        let res = await fetch(`http://www.omdbapi.com/?apikey=453161dd&tt1285016&t=${movieName}`);
        let movieDetails = await res.json();
        console.log( movieDetails );

        // the whole card
        let div = document.createElement('div');

        let img = document.createElement('img');
        img.src = movieDetails.Poster;

        // content box
        {
            let contentBox = document.createElement('div');
            contentBox.style.padding = '0px 20px'
    
            let title = document.createElement('h3');
            title.textContent = movieDetails.Title;
    
            let director = document.createElement('div');
            director.innerHTML = `<b>Director - </b>  ${movieDetails.Director}`
    
    
            // year, duration, and language
            let yearAndDuration = document.createElement('div');
            yearAndDuration.style.display = 'flex';
            let year = document.createElement('div');
            year.innerHTML = `<b>Year - </b> ${movieDetails.Year}`;
            let duration = document.createElement('div');
            duration.innerHTML = `&nbsp&nbsp&nbsp${movieDetails.Runtime}`
            let language = document.createElement('div');
            language.innerHTML = `&nbsp&nbsp&nbsp<b>Language - </b>  ${movieDetails.Language}`
            yearAndDuration.append( year, duration, language );
    
    
            // rating and genre
            let ratingAndGenre = document.createElement('div');
            ratingAndGenre.style.display = 'flex';
            let rating = document.createElement('div');
            rating.innerHTML = '<b>Rating - </b>' + movieDetails.imdbRating + '    ';
            let genre = document.createElement('div');
            genre.innerHTML = `&nbsp&nbsp&nbsp <b>Genre:</b> ${movieDetails.Genre}`;
            ratingAndGenre.append(rating,genre);
    
            let cast = document.createElement('div');
            cast.innerHTML = `<b>Cast: </b>   ${movieDetails.Actors}`;
    
            let plot = document.createElement('div');
            plot.innerHTML = `<div><b>PLOT</b></div><p>${movieDetails.Plot}</p>`
            plot.style.border = '2px solid #1f1e1e';
            plot.style.borderRadius = '5px';
            plot.style.padding = '10px';
            plot.style.marginTop = '20px';
    
            contentBox.append(title, director, yearAndDuration, ratingAndGenre, cast, plot );
            div.append(img, contentBox )
            container.append( div );
        }
    }

    // Main wrapper funtion -- done
    async function main() {
        let name = document.getElementById('query').value;
        if( name.length < 3 ) return false;

        let res = await searchMovies(name);
        appendMovies( res.Search );
    }

    // debouncing 
    function debounce(func, delay) {
        if( timerId ) {
            clearTimeout( timerId );
        }

        timerId = setTimeout(function() {
            func();
        },delay)
    }

</script>

<!-- trending movies -->
<script>

    // fetching trending movies
    async function getTrendingList(){
        let res = await fetch(`https://api.themoviedb.org/3/trending/all/day?api_key=49deaea156b5a0c7f8912b2ed638a131`);
        let data = await res.json();

        // console.log( data );
        showPopular( data.results );
    }
    getTrendingList();

    // displaying movies list
    function showPopular( movieList ) {
        let container = document.getElementById('popular-movies');
        container.innerHTML = "";

        movieList.forEach( async (list) => {

            let container = document.getElementById('popular-movies');
            let div = document.createElement('div');

            let img = document.createElement('img');
            img.src = `https://image.tmdb.org/t/p/w500${list.poster_path}`;

            let contentDiv = document.createElement('div');

            let movieName = document.createElement('h4');
            let nameContent = list.name;
            if( !nameContent ) nameContent = list.title;
            movieName.innerText = nameContent;

            let rating = document.createElement('h5');
            rating.textContent = `Rating - ${list.vote_average}`

            let overview = document.createElement('p');
            overview.textContent = list.overview;

            contentDiv.append( movieName, rating, overview );
            div.append( img, contentDiv );
            container.append( div );
        })
    }
</script> 

<!-- genre -->
<script>
    
    // get movies by genre
    async function getGenre( id ){  
        // https://api.themoviedb.org/3/genre/movie/list?api_key=49deaea156b5a0c7f8912b2ed638a131&language=en-US
        // let res = await fetch(`https://api.themoviedb.org/3/genre/movie/list?api_key=49deaea156b5a0c7f8912b2ed638a131&language=en-US`);
        // res = await res.json();
        // console.log( 'genre', res);

        // https://api.themoviedb.org/3/list/{list_id}?api_key=<<api_key>>&language=en-US
        let genre = await fetch(`https://api.themoviedb.org/3/list/${id}?api_key=49deaea156b5a0c7f8912b2ed638a131&language=en-US`);
        genre = await genre.json();
        // console.log( 'genre', genre );
        showPopular(genre.items);
    }
</script>

<!-- log in and sign up -->
<script>
    // new user signup
    async function sUp() {
        let data = {
            name: document.getElementById('signup-name').value,
            email: document.getElementById('signup-email').value,
            password: document.getElementById('signup-password').value,
            username: document.getElementById('signup-username').value,
            mobile: document.getElementById('signup-mobile').value,
            description: document.getElementById('signup-name').value,
        }
        
        try {
              let res = await fetch(`https://masai-api-mocker.herokuapp.com/auth/register`, {
                method: 'POST',
                body: JSON.stringify(data),
                headers: {
                    'Content-Type':'application/json'
                }
            })
            let out = await res.json();

            let msg = document.getElementById('message');
            msg.style.display = 'inline';
            msg.style.innerText = "";

            if( out.message == 'Registration Success') {
                msg.style.color = 'green';
                msg.innerText = "Account Successfully Created";
            } 
            else if( out.message == 'Registration failed, user already exists') {
                msg.style.color = 'red';
                msg.innerHTML = "Account already Exists";
            }
        }
        catch(e) { console.log( 'data not posted') }
    }

    // user login
    async function lIn() {
        let signup = document.getElementById('signup');
        signup.style.display = 'none';

        let login = document.getElementById('login');
        login.style.display = 'inline';

        let data = {
            username : document.getElementById('login-username').value,
            password : document.getElementById('login-password').value,
        }
        let data_to_send = JSON.stringify(data);

        let res = await fetch(`https://masai-api-mocker.herokuapp.com/auth/login`,{
            method: 'POST',
            body: data_to_send,
            headers: {
                'Content-Type':'application/json'
            }
        })
        let out = await res.json();

        fetchUserData(data.username,out.token);
    }

    // login validation
    async function fetchUserData(username, token) {

        fetch(`https://masai-api-mocker.herokuapp.com/user/${username}`, {
            headers: {
                'Content-Type':'application/json',
                Authorization: `Bearer ${token}`
            }
        })
        .then((res) => {
            return res.json();
        })
        .then((out) => {
            console.log( out );
            let msg = document.getElementById('message');
            msg.style.display = 'inline';

            if( out.username ) { 
                msg.innerText = "Login Successful";
                msg.style.color = 'green';
            }
            else{
                msg.style.color = 'red';
                msg.innerText = "Invalid login credentials";
            } 

            let username = document.getElementById('login-username');
            let pass = document.getElementById('login-password');
            username.value = ""; pass.value = "";
        })
    }
    
    // show and hide elements
    function showHide(showId,hideId) {
        let showEle = document.getElementById(showId);
        console.log( showEle );
        showEle.style.display = 'inline';

        let hideEle = document.getElementById(hideId);
        hideEle.style.display = 'none';
    }

    // toggle element display
    function toggle( id )
    {
        let ele = document.getElementById(id);

        if( ele.style.display == 'none' ) ele.style.display = 'inline';
        else ele.style.display = 'none';
    }
</script>   