<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #container {
            display: grid;
            grid-gap:40px;
            grid-template-columns: repeat(4, 23%);
            margin:50px auto;
            width: 75%;
        }
        body #container .card {
            border: 1px solid grey;
            height: 400px;
            width: 200px;
        }
        #container img {
            width: 100%;
            height:250px;
        }
        #container h3 {
            height:50px;
        }
        #container h5 {
            margin:10px;
        }
    </style>
</head>
<body>
    <!-- 453161dd -->
    
    <input type = 'text' id = 'name' placeholder = 'Enter movie name' />
    <button onclick = 'getData()'>Search</button>

    <div id = 'container'></div>

    <script>
        // making the network request
        async function getData( ) {
            let name = document.getElementById('name');
            let movieList = await fetch(`http://www.omdbapi.com/?apikey=453161dd&tt1285016&s=${name.value}`);
            let data = await movieList.json();

            showMatched(data.Search); //console.log( data.Search );
        }

        // displaying the data after fetching.
        function showMatched( data ) 
        {
            let container = document.getElementById("container");
            let name = document.getElementById('name');
            container.innerHTML = ""; name.value = "";

            // looping through each movie and creating a movie box with all details
            data.forEach( async function( item ) {
                let div = document.createElement('div');
                div.class = 'card';

                let img = document.createElement('img');
                img.src = item.Poster;
    
                let movieName = document.createElement('h3');
                movieName.textContent = item.Title;

                // let type = document.createElement('h4');
                // type.textContent = item.Type;

                let year = document.createElement('h5');
                year.textContent = 'Year - ' + item.Year;

                let rating = document.createElement('h5');
                rating.innerText = 'Rating - ' + await getRating(item);

                div.append( img, movieName, year, rating );
                container.append(div);
            });

            
            // getting the movie by imdbID and returning its imdbRating
            async function getRating( id ) {
                let res = await fetch(`http://www.omdbapi.com/?apikey=453161dd&tt1285016&i=${id.imdbID}`);
                let rating = await res.json();

                console.log( rating.imdbRating);
                return rating.imdbRating;
            }
        }
    </script>
</body>
</html>